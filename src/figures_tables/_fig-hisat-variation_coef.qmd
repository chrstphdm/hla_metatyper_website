---
title: ""
execute:
  echo: false
jupyter: python3
output: word_document
cap-location: bottom
format: 
  html:
    page-layout: full
  pdf:
    pdf-engine: lualatex
    fontsize: 12pt
    mainfont: Open Sans
    sansfont: Open Sans
    # classoption: landscape
    pagestyle: empty
    include-in-header: 
      text: |
        \usepackage[top=0.5mm, left=10mm, right=10mm, bottom=0.5mm]{geometry}
        \usepackage{lscape}
        \newcommand{\blandscape}{\begin{landscape}}
        \newcommand{\elandscape}{\end{landscape}}
  
---

```{python}
#| label: fig-hisat-variation_coef
#| fig-cap: "This figure show coefficient of variation of number of allele1's reads, allele2's reads and sum of allele1&2 reads for each gene. This is a ratio between the mean and the variance of these variables and it allow us to compare the variability of each variable between genes"
#| warning: false
import matplotlib.pyplot as plt
import pandas
rez_hisat = pandas.read_csv('data/rez')
rez_grouped_hisat = rez_hisat.loc[~rez_hisat['hisat_genotype'].isna()].groupby('gene')['hisat_ratio']
df_mean = rez_grouped_hisat.mean()
df_var = rez_grouped_hisat.var()
df_cv = df_var / df_mean * 100
df_cv.plot(kind='bar')
# display(variance_grouped)
```